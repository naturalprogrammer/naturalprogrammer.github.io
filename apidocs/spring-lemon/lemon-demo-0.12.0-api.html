<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<meta name="author" content="Spring Lemon version 0.12">
<title>Spring Lemon Demo API Reference</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
</head>
<body class="book toc2 toc-right">
<div id="header">
<h1>Spring Lemon Demo API Reference</h1>
<div class="details">
<span id="author" class="author">Spring Lemon version 0.12</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_basics">Basics</a>
<ul class="sectlevel2">
<li><a href="#_cors">CORS</a></li>
<li><a href="#_handling_errors">Handling Errors</a></li>
<li><a href="#_format_of_the_error_data">Format of the error data</a></li>
<li><a href="#_json_vulnerability">JSON vulnerability</a></li>
</ul>
</li>
<li><a href="#_ping">Ping</a>
<ul class="sectlevel2">
<li><a href="#_request">Request</a></li>
<li><a href="#_response">Response</a></li>
<li><a href="#_business_rules">Business rules</a></li>
<li><a href="#_positive_test_cases">Positive test cases</a></li>
</ul>
</li>
<li><a href="#_ping_and_create_session">Ping and create session</a>
<ul class="sectlevel2">
<li><a href="#_request_2">Request</a></li>
<li><a href="#_response_2">Response</a></li>
<li><a href="#_business_rules_2">Business rules</a></li>
<li><a href="#_positive_test_cases_2">Positive test cases</a></li>
</ul>
</li>
<li><a href="#_get_context">Get context</a>
<ul class="sectlevel2">
<li><a href="#_request_3">Request</a></li>
<li><a href="#_response_3">Response</a></li>
<li><a href="#_business_rules_3">Business rules</a></li>
<li><a href="#_positive_test_cases_3">Positive test cases</a></li>
</ul>
</li>
<li><a href="#_login">Login</a>
<ul class="sectlevel2">
<li><a href="#_request_4">Request</a></li>
<li><a href="#_response_4">Response</a></li>
<li><a href="#_business_rules_4">Business rules</a></li>
<li><a href="#_positive_test_cases_4">Positive test cases</a></li>
<li><a href="#_negative_test_cases">Negative test cases</a></li>
</ul>
</li>
<li><a href="#_logout">Logout</a>
<ul class="sectlevel2">
<li><a href="#_request_5">Request</a></li>
<li><a href="#_response_5">Response</a></li>
<li><a href="#_business_rules_5">Business rules</a></li>
<li><a href="#_positive_test_cases_5">Positive test cases</a></li>
</ul>
</li>
<li><a href="#_switch_user">Switch user</a>
<ul class="sectlevel2">
<li><a href="#_switching_to_another_user">Switching to another user</a></li>
<li><a href="#_switching_back">Switching back</a></li>
<li><a href="#_business_rules_6">Business rules</a></li>
<li><a href="#_positive_test_cases_6">Positive test cases</a></li>
<li><a href="#_negative_test_cases_2">Negative test cases</a></li>
</ul>
</li>
<li><a href="#_sign_up">Sign up</a>
<ul class="sectlevel2">
<li><a href="#_request_6">Request</a></li>
<li><a href="#_response_6">Response</a></li>
<li><a href="#_business_rules_7">Business rules</a></li>
<li><a href="#_positive_test_cases_7">Positive test cases</a></li>
<li><a href="#_negative_test_cases_3">Negative test cases</a></li>
</ul>
</li>
<li><a href="#_resend_verification_mail">Resend verification mail</a>
<ul class="sectlevel2">
<li><a href="#_request_7">Request</a></li>
<li><a href="#_response_7">Response</a></li>
<li><a href="#_business_rules_8">Business rules</a></li>
<li><a href="#_test_cases">Test cases</a></li>
</ul>
</li>
<li><a href="#VerificationMail">Verify user</a>
<ul class="sectlevel2">
<li><a href="#_request_8">Request</a></li>
<li><a href="#_response_8">Response</a></li>
<li><a href="#_business_rules_9">Business rules</a></li>
<li><a href="#_positive_test_cases_8">Positive test cases</a></li>
<li><a href="#_negative_test_cases_4">Negative test cases</a></li>
</ul>
</li>
<li><a href="#ForgotPassword">Forgot Password</a>
<ul class="sectlevel2">
<li><a href="#_request_9">Request</a></li>
<li><a href="#_response_9">Response</a></li>
<li><a href="#_business_rules_10">Business rules</a></li>
<li><a href="#_positive_test_cases_9">Positive test cases</a></li>
<li><a href="#_negative_test_cases_5">Negative test cases</a></li>
</ul>
</li>
<li><a href="#reset_his_password">Reset password</a>
<ul class="sectlevel2">
<li><a href="#_request_10">Request</a></li>
<li><a href="#_response_10">Response</a></li>
<li><a href="#_business_rules_11">Business rules</a></li>
<li><a href="#_positive_test_cases_10">Positive test cases</a></li>
<li><a href="#_negative_test_cases_6">Negative test cases</a></li>
</ul>
</li>
<li><a href="#_fetch_user_by_email">Fetch user by email</a>
<ul class="sectlevel2">
<li><a href="#_request_11">Request</a></li>
<li><a href="#_response_11">Response</a></li>
<li><a href="#_business_rules_12">Business rules</a></li>
<li><a href="#_positive_test_cases_11">Positive test cases</a></li>
<li><a href="#_negative_test_cases_7">Negative test cases</a></li>
</ul>
</li>
<li><a href="#_fetch_user_by_id">Fetch user by ID</a>
<ul class="sectlevel2">
<li><a href="#_request_12">Request</a></li>
<li><a href="#_response_12">Response</a></li>
<li><a href="#_business_rules_13">Business rules</a></li>
<li><a href="#_positive_test_cases_12">Positive test cases</a></li>
<li><a href="#_negative_test_cases_8">Negative test cases</a></li>
</ul>
</li>
<li><a href="#_update_user">Update user</a>
<ul class="sectlevel2">
<li><a href="#_request_13">Request</a></li>
<li><a href="#_response_13">Response</a></li>
<li><a href="#_business_rules_14">Business rules</a></li>
<li><a href="#_positive_test_cases_13">Positive test cases</a></li>
<li><a href="#_negative_test_cases_9">Negative test cases</a></li>
</ul>
</li>
<li><a href="#_change_password">Change password</a>
<ul class="sectlevel2">
<li><a href="#_request_14">Request</a></li>
<li><a href="#_response_14">Response</a></li>
<li><a href="#_business_rules_15">Business rules</a></li>
<li><a href="#_positive_test_cases_14">Positive test cases</a></li>
<li><a href="#_negative_test_cases_10">Negative test cases</a></li>
</ul>
</li>
<li><a href="#request-for-changing-email">Requesting for changing email</a>
<ul class="sectlevel2">
<li><a href="#_request_15">Request</a></li>
<li><a href="#_response_15">Response</a></li>
<li><a href="#_business_rules_16">Business Rules</a></li>
<li><a href="#_positive_test_cases_15">Positive test cases</a></li>
<li><a href="#_negative_test_cases_11">Negative test cases</a></li>
</ul>
</li>
<li><a href="#_change_email">Change email</a>
<ul class="sectlevel2">
<li><a href="#_request_16">Request</a></li>
<li><a href="#_response_16">Response</a></li>
<li><a href="#_business_rules_17">Business rules</a></li>
<li><a href="#_positive_test_cases_16">Positive test cases</a></li>
<li><a href="#_negative_test_cases_12">Negative test cases</a></li>
</ul>
</li>
<li><a href="#_create_api_key">Create API Key</a>
<ul class="sectlevel2">
<li><a href="#_request_17">Request</a></li>
<li><a href="#_response_17">Response</a></li>
<li><a href="#_business_rules_18">Business Rules</a></li>
</ul>
</li>
<li><a href="#_use_api_key">Use API Key</a>
<ul class="sectlevel2">
<li><a href="#_request_18">Request</a></li>
<li><a href="#_response_18">Response</a></li>
</ul>
</li>
<li><a href="#_remove_api_key">Remove API Key</a>
<ul class="sectlevel2">
<li><a href="#_request_19">Request</a></li>
<li><a href="#_response_19">Response</a></li>
<li><a href="#_business_rules_19">Business Rules</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is the API documentation of <a href="https://github.com/naturalprogrammer/lemon-demo">Spring Lemon Demo application</a>. This API can be called from browser based front-ends (e.g. AngularJS single page applications), as well as non-browser clients.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basics">Basics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before we dive in, let&#8217;s first look at a few key thing to keep in mind when using the API.</p>
</div>
<div class="sect2">
<h3 id="_cors">CORS</h3>
<div class="paragraph">
<p>Your API could be accessed from multiple clients. One of those could be a JavaScript web front-end, such as an AngularJS single page application.</p>
</div>
<div class="paragraph">
<p>When developing a JavaScript web front-end, you will have two choices:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Put it in the same project, say inside <em>src/main/resources/static</em>, and deploy both the server and the client as a single unit.</p>
</li>
<li>
<p>Keep it separate, say as a <em>Grunt</em> project, and deploy it in a different domain. For example, your API could be hosted at <code>example.cfapps.io</code>, whereas your AngularJS application could be hosted at <code>www.example.com</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you go for the second option, your JavaScript can&#8217;t call your API unless you deal with the <a href="https://en.wikipedia.org/wiki/Same-origin_policy">same origin policy</a>.</p>
</div>
<div class="paragraph">
<p>Spring Lemon uses CORS at the server side to deal with this. You just have to add a line like this in <em>application.properties</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>lemon.cors.allowed-origins: http://localhost:9000,http://www.example.com</pre>
</div>
</div>
<div class="paragraph">
<p>You may also need a little configuration at the client side. For example, in AngularJS, you will need to set the <code>withCredentials</code> flag of <a href="https://docs.angularjs.org/api/ng/service/$http#cross-site-request-forgery-xsrf-protection">$http</a> service, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">angular.module('myApp', ['ngCookies', ... ])
.config(['$httpProvider', function ($httpProvider) {

    $httpProvider.defaults.withCredentials = true;
    ...
}]);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Refer <a href="https://gum.co/exuo/associate">Spring Framework REST API Development - A Complete Blueprint</a> for details.</p>
</div>
<div class="sect3">
<h4 id="_csrf">CSRF</h4>
<div class="paragraph">
<p><em>CSRF</em> is a well known security vulnerability. If you do not know about it, <a href="http://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#csrf">Spring Security reference material</a> explains it beautifully.</p>
</div>
<div class="paragraph">
<p>To handle CSRF, Spring Lemon sends a token to the client in each response. The token is sent as a cookie, named <code>XSRF-TOKEN</code>. Then, in each <code>PATCH</code>, <code>POST</code>, <code>PUT</code> or <code>DELETE</code> request, it expects the same token as a header named <code>X-XSRF-TOKEN</code>. An exception is thrown if the tokens do not match.</p>
</div>
<div class="paragraph">
<p>So, your client application should first send a GET request for getting the token, and then use that in POST kind of requests. Also, be aware that Spring Security removes or changes the cookie after certain events, like <em>logout</em>. Hence, after these events, your client application will again need to send some GET request and get the new token. Ping (see below) can be used for this.</p>
</div>
<div class="paragraph">
<p>When wrong CSRF token is sent, the response looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">HTTP/1.1 403 Forbidden

{
"status": 403,
"error": "Forbidden",
"message": "Expected CSRF token not found. Has your session expired?",
"path": "/accessed_url"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The book <a href="https://gum.co/exuo/associate">Spring Framework REST API Development - A Complete Blueprint</a> covers it in details.</p>
</div>
<div class="sect4">
<h5 id="_csrf_and_angularjs">CSRF and AngularJS</h5>
<div class="paragraph">
<p>If your AngularJS client resides in the same project, say inside <em>src/main/resources/static</em>, you don&#8217;t have to do anything special for CSRF. When sending a request, the <a href="https://docs.angularjs.org/api/ng/service/$http#cross-site-request-forgery-xsrf-protection">$http</a> service of AngularJS automatically puts the value of the <code>XSRF-TOKEN</code> cookie in a header named <code>X-XSRF-TOKEN</code>.</p>
</div>
<div class="paragraph">
<p>If you have the client as a separate project that is to be hosted separately though, you will have to add the header on your own. The easiest way to do it is to write an AngularJS <em>$http interceptor</em>, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">angular.module('myApp')
  .factory('XSRFInterceptor', function ($cookies, $log) {

    var xsrfToken;

    var XSRFInterceptor = {

      request: function(config) {

        if (xsrfToken) {
          config.headers['X-XSRF-TOKEN'] = xsrfToken;
          $log.info("X-XSRF-TOKEN being sent to server: " + xsrfToken);
        }

        return config;
      },

      response: function(response) {

        var newToken = $cookies.get('XSRF-TOKEN');

        if (newToken) {
          xsrfToken = newToken;
          $log.info("XSRF-TOKEN received from server: " + xsrfToken);
        }

        return response;
      }
    };

    return XSRFInterceptor;
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>You then need to configure the interceptor as below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">angular.module('myApp', [...])
   .config(['$httpProvider', function ($httpProvider) {

   $httpProvider.defaults.withCredentials = true;
   $httpProvider.interceptors.push('XSRFInterceptor');
   ...

}]);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_handling_errors">Handling Errors</h3>
<div class="paragraph">
<p>If some request data would not comply to the business rules, the API would respond with <em>422 Unprocessable Entity</em>, with a JSON body holding field-wise error details. For example, trying to sign up with some invalid data could produce the following JSON data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "timestamp": 1494764056076,
  "status": 422,
  "error": "Unprocessable Entity",
  "exception": "javax.validation.ConstraintViolationException",
  "message": "Validation Error",
  "path": "/api/core/users",
  "errors": [
    {
      "field": "user.password",
      "code": "{com.naturalprogrammer.spring.invalid.password.size}",
      "message": "Password must be between 6 and 50 characters"
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each error in <code>errors</code> above will have three fields:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>field</strong>: Name of the field, or <em>null</em> in case of a form level error.</p>
</li>
<li>
<p><strong>code</strong>: The error code.</p>
</li>
<li>
<p><strong>message</strong>: An internationalized message, which could vary depending on the locale of the user.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_format_of_the_error_data">Format of the error data</h3>
<div class="paragraph">
<p>Obviously, the format of the error JSON, its field names and codes would vary from request to request. Maintaining a documentation of each error for each request would be cumbersome. We may take that up sometime in future, but for now, the best way to know the format for any request would be to look at the actual response body by using a tool, such as the <em>google chrome developer tools</em> or <em>Postman</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_json_vulnerability">JSON vulnerability</h3>
<div class="paragraph">
<p>By default, Spring Lemon prefixes JSON responses with <code>)]}',\n</code>. This is done as a protection against the <a href="http://haacked.com/archive/2008/11/20/anatomy-of-a-subtle-json-vulnerability.aspx">JSON vulnerability</a>. Your client application would need to strip this <code>)]}',\n</code>. It&#8217;s done automatically if you are using the <a href="https://docs.angularjs.org/api/ng/service/$http#json-vulnerability-protection">$http</a> service of AngularJS.</p>
</div>
<div class="paragraph">
<p>If you want to disable this protection, maybe because your API is not meant to be called from browsers, add the following line in application.properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>lemon.enabled.json-prefix: false</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ping">Ping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sends a GET request to the server. This is useful for fetching the CSRF cookie after an event that would have changed the CSRF token, e.g. <em>logout</em>. See the discussion on CSRF above for more details.</p>
</div>
<div class="paragraph">
<p>In summary, you may need to call this before any request that results in <em>CSRF mismatch</em> error.</p>
</div>
<div class="sect2">
<h3 id="_request">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">GET /api/core/ping HTTP/1.1
Accept: */*
Host: www.example.com</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_response">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 204 No Content
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Set-Cookie: XSRF-TOKEN=be5c3259-15ce-4310-b582-07b038d83ff8;path=/
Date: Sun, 14 May 2017 14:07:51 GMT</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice how we get the CSRF cookie in the response, which is to be sent as a header in next requests.</p>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Should return a 204 No Content with a cookie named "XSRF-TOKEN"</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Should return a 204 No Content with a cookie named "XSRF-TOKEN"</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ping_and_create_session">Ping and create session</h2>
<div class="sectionbody">
<div class="paragraph">
<p>From a browser based client, you may like to create a session so that you can use cookie based authentication. To do so, call this.</p>
</div>
<div class="sect2">
<h3 id="_request_2">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">GET /api/core/ping-session HTTP/1.1
Accept: */*
Host: www.example.com</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_response_2">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 204 No Content
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Set-Cookie: XSRF-TOKEN=868cd74f-f761-4861-8205-7b68a36d33b6;path=/
Set-Cookie: JSESSIONID=14F3752E28161E93FFDA156C8717B816;path=/;HttpOnly
Date: Sun, 14 May 2017 14:07:51 GMT</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice the classic JSESSIONID cookie in the response.</p>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_2">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Should return a 204 No Content with a cookie named "JSESSIONID"</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_2">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Should return a 204 No Content with a cookie named "JSESSIONID"</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_get_context">Get context</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gets useful application properties and current user data.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Call this to fetch useful application properties and current-user data when an AngularJS application starts.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_request_3">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">GET /api/core/context HTTP/1.1
Accept: application/json;charset=UTF-8
Host: www.example.com</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_response_3">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Set-Cookie: XSRF-TOKEN=d68ca546-e3a8-43b1-ba63-d0c9742642a8;path=/
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Sun, 14 May 2017 14:07:51 GMT
Content-Length: 733

{
  "context" : {
    "shared" : {
      "fooBar" : "123..."
    }
  },
  "user" : {
    "id" : 12,
    "email" : "admin@example.com",
    "roles" : [ "ADMIN" ],
    "unverified" : false,
    "blocked" : false,
    "admin" : true,
    "goodUser" : true,
    "goodAdmin" : true,
    "editable" : true,
    "rolesEditable" : false,
    "authorities" : [ {
      "authority" : "ROLE_ADMIN"
    }, {
      "authority" : "ROLE_GOOD_USER"
    }, {
      "authority" : "ROLE_GOOD_ADMIN"
    } ],
    "name" : "Administrator",
    "username" : "admin@example.com",
    "accountNonLocked" : true,
    "credentialsNonExpired" : true,
    "accountNonExpired" : true,
    "enabled" : true,
    "new" : false
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Fields</strong></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Path</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>context</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Context object containing attributes like <em>reCaptchaSiteKey</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>context.shared</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All the <em>lemon.shared.*</em> properties that are defined in <em>application\*.yml</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logged-in user details</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><em>user</em> would be omitted if nobody is logged in.</p>
</div>
<div class="paragraph">
<p>Refer the book <a href="https://gum.co/exuo/associate">Spring Framework REST API Development - A Complete Blueprint</a> to know how to customize this response and other details.</p>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_3">Business rules</h3>
<div class="paragraph">
<p>The <em>current-user</em> data, <em>reCaptchaSiteKey</em>, and the <em>lemon.shared.*</em> properties should be there in the response. Current-user data shouldn&#8217;t include any confidential fields.</p>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_3">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When not logged in, <em>reCaptchaSiteKey</em>, <em>lemon.shared.*</em> properties should be there in the response. Current user data should be absent.</p>
</li>
<li>
<p>When logged in, <em>reCaptchaSiteKey</em>, <em>lemon.shared.*</em> properties should be there in the response. Current user data should look as above, with confidential fields omitted..</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_login">Login</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Logs the user in. To remember the user for 15 days, send a <em>rememberMe</em> parameter set as <code>true</code>.</p>
</div>
<div class="sect2">
<h3 id="_request_4">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">POST /login HTTP/1.1
Accept: */*
X-XSRF-TOKEN: cf24ce13-e3e8-42ea-82f2-b5fbcd75e50e
Content-Type: application/x-www-form-urlencoded; charset=ISO-8859-1
Host: www.example.com

username=admin%40example.com&amp;password=admin%21&amp;rememberMe=true</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Parameters</strong></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>username</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The login id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rememberMe</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to remember the login even after session expires</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_response_4">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Set-Cookie: JSESSIONID=764FDFB24DBC2B21368A98D67189A8A1;path=/;HttpOnly
Set-Cookie: XSRF-TOKEN=;Max-Age=0;path=/
Set-Cookie: XSRF-TOKEN=aed9008a-495e-4835-a9ca-6e39407c128e;path=/
Set-Cookie: rememberMe=YWRtaW5AZXhhbXBsZS5jb206MTQ5NTk4MDQ3MDY3MDoxNDI2ZTRiYmQ1NzFhYjU5ZjM5MjM3MWZjNGZlYTUwNA;Max-Age=1209600;path=/;HttpOnly
Content-Type: application/json
Content-Length: 590
Date: Sun, 14 May 2017 14:07:50 GMT

{
  "id" : 3,
  "email" : "admin@example.com",
  "roles" : [ "ADMIN" ],
  "unverified" : false,
  "blocked" : false,
  "admin" : true,
  "goodUser" : true,
  "goodAdmin" : true,
  "editable" : true,
  "rolesEditable" : false,
  "authorities" : [ {
    "authority" : "ROLE_ADMIN"
  }, {
    "authority" : "ROLE_GOOD_USER"
  }, {
    "authority" : "ROLE_GOOD_ADMIN"
  } ],
  "name" : "Administrator",
  "username" : "admin@example.com",
  "accountNonLocked" : true,
  "credentialsNonExpired" : true,
  "accountNonExpired" : true,
  "enabled" : true,
  "new" : false
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_4">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Upon successful login, current-user data should be returned as the response.</p>
</li>
<li>
<p>Giving wrong credentials should respond with <code>401 Aunauthorized</code>.</p>
</li>
<li>
<p>Spring security token based <a href="http://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#remember-me">remember-me</a> rules apply. Importantly,</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>A <code>rememberMe</code> cookie is returned when <code>rememberMe=true</code> is passed as a request parameter.</p>
</li>
<li>
<p>Sending the remember me cookie from a different session within 15 days would log the user in.</p>
</li>
<li>
<p>Upon logout, the cookie is reset.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_4">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When a good ADMIN logs in, the response should contain</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>his <code>name</code></p>
</li>
<li>
<p>a <code>roles</code> collection with role "ADMIN"</p>
</li>
<li>
<p><code>goodAdmin</code> as true</p>
</li>
</ol>
</div>
</li>
<li>
<p>When <code>rememberMe=true</code> parameter is sent, a <code>rememberMe</code> cookie is received. That cookie can be used in a different session to log the user in. Upon logging out from that session, the <code>rememberMe</code> cookie is reset.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_negative_test_cases">Negative test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Giving wrong credentials should respond with <code>401 Aunauthorized</code>.</p>
</li>
<li>
<p>A wrong <code>rememberMe</code> cookie should not log a user in.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logout">Logout</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Logs a user out.</p>
</div>
<div class="sect2">
<h3 id="_request_5">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">POST /logout HTTP/1.1
Accept: */*
X-XSRF-TOKEN: 23af69ee-959f-4b7e-9a60-f3e02204c35b
Content-Type: application/x-www-form-urlencoded; charset=ISO-8859-1
Host: www.example.com</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_response_5">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Set-Cookie: JSESSIONID=;Max-Age=0;path=/
Set-Cookie: rememberMe=;Max-Age=0;path=/
Set-Cookie: XSRF-TOKEN=;Max-Age=0;path=/
Date: Sun, 14 May 2017 14:07:50 GMT</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_5">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Should log the user out, and send a 200 OK.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_5">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Should log the user out, and send a 200 OK.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_switch_user">Switch user</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_switching_to_another_user">Switching to another user</h3>
<div class="paragraph">
<p>Let&#8217;s a good ADMIN switch to another user. For example, a support guy can switch to another user while examining a complaint.</p>
</div>
<div class="paragraph">
<p><strong>Request</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">POST /login/impersonate HTTP/1.1
Accept: */*
X-XSRF-TOKEN: 7d891c31-2ff6-475b-b2af-3c44e874d906
Content-Type: application/x-www-form-urlencoded; charset=ISO-8859-1
Host: www.example.com

username=user1%40example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Response</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Content-Type: application/json
Content-Length: 507
Date: Sun, 14 May 2017 14:08:05 GMT

{
  "id" : 86,
  "email" : "user1@example.com",
  "roles" : [ "UNVERIFIED" ],
  "unverified" : true,
  "blocked" : false,
  "admin" : false,
  "goodUser" : false,
  "goodAdmin" : false,
  "editable" : true,
  "rolesEditable" : false,
  "authorities" : [ {
    "authority" : "ROLE_UNVERIFIED"
  } ],
  "name" : "User 1",
  "username" : "user1@example.com",
  "accountNonLocked" : true,
  "credentialsNonExpired" : true,
  "accountNonExpired" : true,
  "enabled" : true,
  "new" : false
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_switching_back">Switching back</h3>
<div class="paragraph">
<p><strong>Request</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">POST /logout/impersonate HTTP/1.1
Accept: */*
X-XSRF-TOKEN: d096c356-d4d7-4213-a458-1335b196c49a
Content-Type: application/x-www-form-urlencoded; charset=ISO-8859-1
Host: www.example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Response</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Content-Type: application/json
Content-Length: 591
Date: Sun, 14 May 2017 14:08:05 GMT

{
  "id" : 85,
  "email" : "admin@example.com",
  "roles" : [ "ADMIN" ],
  "unverified" : false,
  "blocked" : false,
  "admin" : true,
  "goodUser" : true,
  "goodAdmin" : true,
  "editable" : true,
  "rolesEditable" : false,
  "authorities" : [ {
    "authority" : "ROLE_ADMIN"
  }, {
    "authority" : "ROLE_GOOD_USER"
  }, {
    "authority" : "ROLE_GOOD_ADMIN"
  } ],
  "name" : "Administrator",
  "username" : "admin@example.com",
  "accountNonLocked" : true,
  "credentialsNonExpired" : true,
  "accountNonExpired" : true,
  "enabled" : true,
  "new" : false
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_6">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Only good ADMINs should be able to switch.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_6">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A good ADMIN should be able to switch to another user, and then switch back.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_negative_test_cases_2">Negative test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A non-admin should not be able to switch.</p>
</li>
<li>
<p>An unauthenticated user should not be able to switch.</p>
</li>
<li>
<p>A bad ADMIN should not able to switch.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sign_up">Sign up</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Signs up a new user and logs him in. A <a href="#VerificationMail">verification mail</a> is sent to his email.</p>
</div>
<div class="sect2">
<h3 id="_request_6">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">POST /api/core/users HTTP/1.1
Accept: */*
X-XSRF-TOKEN: 4f849c1b-728b-457a-9ae7-762cd59d808f
Content-Type: application/json;charset=UTF-8
Host: www.example.com
Content-Length: 85

{
  "email" : "user1@example.com",
  "password" : "user1!",
  "name" : "User 1"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add <code>captchaResponse</code> field if you want captcha validation. Sign up let&#8217;s you use the new <a href="https://developers.google.com/recaptcha/">reCAPTCHA</a> from Google. If you use it, <code>captchaResponse</code> field should hold the captcha response. To use it,</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>At the server side, set a couple of properties, as described <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/configuring/setting-up-application-properties.html">here</a>.</p>
</li>
<li>
<p>At the client side, for an AngularJS client, <a href="https://github.com/VividCortex/angular-recaptcha">angular-recaptcha</a> works great. Remember to send the captcha response in the <code>captchaResponse</code> field.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you don&#8217;t want Captcha, e.g. in a demo app, just don&#8217;t provide the captcha related properties in <em>application.yml</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_response_6">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 201 Created
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Sun, 14 May 2017 14:08:04 GMT
Content-Length: 507

{
  "id" : 80,
  "email" : "user1@example.com",
  "roles" : [ "UNVERIFIED" ],
  "unverified" : true,
  "blocked" : false,
  "admin" : false,
  "goodUser" : false,
  "goodAdmin" : false,
  "editable" : true,
  "rolesEditable" : false,
  "authorities" : [ {
    "authority" : "ROLE_UNVERIFIED"
  } ],
  "name" : "User 1",
  "username" : "user1@example.com",
  "accountNonLocked" : true,
  "credentialsNonExpired" : true,
  "accountNonExpired" : true,
  "enabled" : true,
  "new" : false
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_7">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Nobody should have already logged in.</p>
</li>
<li>
<p>Email, password and name should be <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/user_constraints.html">valid</a>.</p>
</li>
<li>
<p>The role UNVERIFIED is added to the user upon sign up.</p>
</li>
<li>
<p>Password is stored encoded.</p>
</li>
<li>
<p>After successful sign up</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The user is signed in.</p>
</li>
<li>
<p>A verification mail is sent to the given email id.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_7">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A user should be able to sign up.</p>
</li>
<li>
<p>After signing up</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The user should have signed in.</p>
</li>
<li>
<p>His role should be UNVERIFIED.</p>
</li>
<li>
<p>A verification mail should have been sent to the user.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_negative_test_cases_3">Negative test cases</h3>
<div class="paragraph">
<p>Sign up will respond with errors if you try it</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After being already logged in.</p>
</li>
<li>
<p>With <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/user_constraints.html">invalid</a> email, password or name.</p>
</li>
<li>
<p>Using an email id which is already signed up.</p>
</li>
<li>
<p>With invalid captcha.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resend_verification_mail">Resend verification mail</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A verification mail is sent to users upon sign up. But, sometimes they may miss it. So, when a unverified user signs in, you may like to show him a button or something to resend the verification mail. Clicking on that should send a request to your API as below.</p>
</div>
<div class="sect2">
<h3 id="_request_7">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">GET /api/core/users/74/resend-verification-mail HTTP/1.1
Accept: */*
Host: www.example.com</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_response_7">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 204 No Content
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Set-Cookie: XSRF-TOKEN=9f17654e-9009-4556-bf99-1d8800f75df0;path=/
Date: Sun, 14 May 2017 14:08:02 GMT</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_8">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user should exist.</p>
</li>
<li>
<p>Current-user should have <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/accessing_users.html">permission to edit</a> the given user.</p>
</li>
<li>
<p>The user should not have been verified.</p>
</li>
<li>
<p>A new verification code isn&#8217;t generated. The existing verification code is used instead. It&#8217;s because sometimes the user might find the old mail, and try verifying with that.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_test_cases">Test cases</h3>
<div class="paragraph">
<p><strong>Positive</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>An unverified user should be able to resend his verification code. The verificationCode of the user should not change in the process.</p>
</li>
<li>
<p>A good ADMIN should be able to resend the verification mail of another unverified user.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Negative</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Providing unknown user id</p>
</li>
<li>
<p>Trying</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>without logging in</p>
</li>
<li>
<p>logging in as a different user</p>
</li>
<li>
<p>logging in as a bad ADMIN</p>
</li>
<li>
<p>while already verified</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="VerificationMail">Verify user</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After a user signs up, he receives a verification mail. The mail contains a link with an embedded <code>verificationCode</code>. Clicking on it takes the user to the front-end application, where he is first asked to login if he is not already, and then click a <em>verify</em> button. On clicking verify, a POST request is sent as below.</p>
</div>
<div class="sect2">
<h3 id="_request_8">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">POST /api/core/users/f971b532-c92a-457c-b6ba-3910233d008c/verify HTTP/1.1
Accept: */*
X-XSRF-TOKEN: d76bd8e2-eb19-4d38-ba68-29d85b8560a8
Content-Type: application/x-www-form-urlencoded; charset=ISO-8859-1
Host: www.example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Path parameters</strong></p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. /api/core/users/{verificationCode}/verify</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>verificationCode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The verification code</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_response_8">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Sun, 14 May 2017 14:08:09 GMT
Content-Length: 494

{
  "id" : 113,
  "email" : "user1@example.com",
  "roles" : [ ],
  "unverified" : false,
  "blocked" : false,
  "admin" : false,
  "goodUser" : true,
  "goodAdmin" : false,
  "editable" : true,
  "rolesEditable" : false,
  "authorities" : [ {
    "authority" : "ROLE_GOOD_USER"
  } ],
  "name" : "User 1",
  "username" : "user1@example.com",
  "accountNonLocked" : true,
  "credentialsNonExpired" : true,
  "accountNonExpired" : true,
  "enabled" : true,
  "new" : false
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_9">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user must have logged in.</p>
</li>
<li>
<p>The user must not have already verified.</p>
</li>
<li>
<p>Verification code shouldn&#8217;t be blank.</p>
</li>
<li>
<p>Verification code should match the code that was mailed to the user while signing up.</p>
</li>
<li>
<p>Upon successful verification, the UNVERIFIED role of the user is removed, and the verification code that was stored in the user record is wiped out.</p>
</li>
<li>
<p>Upon successful commit, security principal&#8217;s UNVERIFIED role is removed, and it&#8217;s flags such as goodUser are computed again.</p>
</li>
<li>
<p>Updated current-user data is returned.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_8">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A new user should be able to sign in, get a verification mail, and verify himself. Check that after verification,</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The same user is returned in the response.</p>
</li>
<li>
<p>His UNVERIFIED role is removed.</p>
</li>
<li>
<p>His verificationCode is set as null.</p>
</li>
<li>
<p>Current-user, which is the user himself, has the following changes:</p>
</li>
<li>
<p>UNVERIFIED role is removed</p>
</li>
<li>
<p>He is now a good user</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_negative_test_cases_4">Negative test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Re-verifying after successful verification.</p>
</li>
<li>
<p>Trying with wrong verification code.</p>
</li>
<li>
<p>Trying without logging the user in.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ForgotPassword">Forgot Password</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a user forgets his password, he can post a form as below.</p>
</div>
<div class="sect2">
<h3 id="_request_9">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">POST /api/core/forgot-password HTTP/1.1
Accept: */*
X-XSRF-TOKEN: 3a1afa36-7863-43a4-8e4c-b00151b759f7
Content-Type: application/x-www-form-urlencoded; charset=ISO-8859-1
Host: www.example.com

email=user1%40example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>It would create a secret <code>forgotPasswordCode</code>, and mail the user a link including that code, looking like <code><a href="https://your-front-end.com/users/{forgotPasswordCode}/reset-password" class="bare">https://your-front-end.com/users/{forgotPasswordCode}/reset-password</a></code>.</p>
</div>
<div class="paragraph">
<p>Clicking on the link should allow the user to <a href="#reset_his_password">reset his password</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_response_9">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 204 No Content
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Date: Sun, 14 May 2017 14:07:59 GMT</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_10">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A user with the given email should exist.</p>
</li>
<li>
<p>The email should be well-formed, and not null or blank.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_9">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Upon posting,</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>A secret code should be generated and stored in the User entity.</p>
</li>
<li>
<p>A mail containing the code should be sent to the user.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_negative_test_cases_5">Negative test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Providing a null, blank or not well formed email.</p>
</li>
<li>
<p>Not having a user with the given email address.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reset_his_password">Reset password</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the <a href="#ForgotPassword">Forgot Password</a> section, we saw how a user gets a link with a <code>forgotPasswordCode</code>. Clicking on the link should take him to a front-end form, where he should enter a new password. Upon submitting that form, a request as below should be sent.</p>
</div>
<div class="sect2">
<h3 id="_request_10">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">POST /api/core/users/57d22186-2c7c-4752-b955-29089b718172/reset-password HTTP/1.1
Accept: */*
X-XSRF-TOKEN: 3a1afa36-7863-43a4-8e4c-b00151b759f7
Content-Type: application/x-www-form-urlencoded; charset=ISO-8859-1
Host: www.example.com

newPassword=a-new-password</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_response_10">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 204 No Content
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Date: Sun, 14 May 2017 14:07:59 GMT</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_11">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user should have initiated the forgot password process.</p>
</li>
<li>
<p>The user shouldn&#8217;t already have reset the password.</p>
</li>
<li>
<p>The new password should be valid.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_10">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The password of the user should be updated, i.e., the user should then be able to login using the new password.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_negative_test_cases_6">Negative test cases</h3>
<div class="paragraph">
<p>The following tries should respond with errors:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Trying with wrong forgotPasswordCode.</p>
</li>
<li>
<p>Repeating resetting password.</p>
</li>
<li>
<p>Invalid new password.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fetch_user_by_email">Fetch user by email</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Example use case - a good ADMIN fetching a user, maybe for changing its roles.</p>
</div>
<div class="sect2">
<h3 id="_request_11">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">GET /api/core/users/fetch-by-email?email=user1%40example.com HTTP/1.1
Accept: */*
Host: www.example.com</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_response_11">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Set-Cookie: XSRF-TOKEN=f1ea1176-e60e-4246-b033-3ae67eed4d63;path=/
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Sun, 14 May 2017 14:07:57 GMT
Content-Length: 525

{
  "id" : 42,
  "version" : 1,
  "email" : "user1@example.com",
  "roles" : [ "UNVERIFIED" ],
  "unverified" : true,
  "blocked" : false,
  "admin" : false,
  "goodUser" : false,
  "goodAdmin" : false,
  "editable" : true,
  "rolesEditable" : false,
  "authorities" : [ {
    "authority" : "ROLE_UNVERIFIED"
  } ],
  "name" : "User 1",
  "username" : "user1@example.com",
  "accountNonLocked" : true,
  "credentialsNonExpired" : true,
  "accountNonExpired" : true,
  "enabled" : true,
  "new" : false
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_12">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Email should be well formed, and not be blank.</p>
</li>
<li>
<p>A user with the given email should exist.</p>
</li>
<li>
<p>The confidential fields would be null in case the current user does not have rights to see those.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_11">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A user should be able to fetch his data, including the confidential email and username. But other <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/accessing_users.html">confidential fields</a> would be omitted.</p>
</li>
<li>
<p>A good ADMIN should be able to fetch another user&#8217;s data, including the confidential email and username. But other <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/accessing_users.html">confidential fields</a> would be omitted.</p>
</li>
<li>
<p>A i) bad ADMIN, ii) non-admin or iii) anonymous user should be able to fetch another user&#8217;s data. But all the <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/accessing_users.html">confidential fields</a> would be omitted.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_negative_test_cases_7">Negative test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Providing blank or non-well-formed email.</p>
</li>
<li>
<p>Providing an unknown email id.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fetch_user_by_id">Fetch user by ID</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Example use case - viewing the profile of a user.</p>
</div>
<div class="sect2">
<h3 id="_request_12">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">GET /api/core/users/39 HTTP/1.1
Accept: */*
Host: www.example.com</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_response_12">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Set-Cookie: XSRF-TOKEN=128942bb-9cb1-47c6-8736-50195e5cde88;path=/
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Sun, 14 May 2017 14:07:57 GMT
Content-Length: 609

{
  "id" : 39,
  "version" : 0,
  "email" : "admin@example.com",
  "roles" : [ "ADMIN" ],
  "unverified" : false,
  "blocked" : false,
  "admin" : true,
  "goodUser" : true,
  "goodAdmin" : true,
  "editable" : true,
  "rolesEditable" : false,
  "authorities" : [ {
    "authority" : "ROLE_ADMIN"
  }, {
    "authority" : "ROLE_GOOD_USER"
  }, {
    "authority" : "ROLE_GOOD_ADMIN"
  } ],
  "name" : "Administrator",
  "username" : "admin@example.com",
  "accountNonLocked" : true,
  "credentialsNonExpired" : true,
  "accountNonExpired" : true,
  "enabled" : true,
  "new" : false
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_13">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A user with the given id should exist.</p>
</li>
<li>
<p>The <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/accessing_users.html">confidential fields</a> would be null in case the current-user does not have rights to see them.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_12">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A user should be able to fetch his data, including the confidential <code>email</code> and <code>username</code>. But other <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/accessing_users.html">confidential fields</a> would be null.</p>
</li>
<li>
<p>A good ADMIN should be able to fetch another user&#8217;s data, including the confidential <code>email</code> and <code>username</code>. But other <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/accessing_users.html">confidential fields</a> would be null.</p>
</li>
<li>
<p>A bad ADMIN, non-admin or an anonymous user should be able to fetch another user&#8217;s data. But all the <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/accessing_users.html">confidential fields</a> would be null.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_negative_test_cases_8">Negative test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Providing an unknown id.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_update_user">Update user</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Updates the name and roles of a user.</p>
</div>
<div class="sect2">
<h3 id="_request_13">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">PATCH /api/core/users/97 HTTP/1.1
Accept: */*
X-XSRF-TOKEN: 95d48dca-51f2-4dc2-ac55-9226986a267d
Content-Type: application/json;charset=UTF-8
Host: www.example.com
Content-Length: 371

[ {
  "op" : "replace",
  "path" : "/name",
  "value" : "Edited name"
}, {
  "op" : "replace",
  "path" : "/email",
  "value" : "should.not@get.replaced"
}, {
  "op" : "replace",
  "path" : "/unverified",
  "value" : false
}, {
  "op" : "replace",
  "path" : "/admin",
  "value" : true
}, {
  "op" : "replace",
  "path" : "/version",
  "value" : 0
} ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you have added more updatable fields to User, they can also be updated using this request.</p>
</div>
<div class="paragraph">
<p><strong>What is version</strong></p>
</div>
<div class="paragraph">
<p>User, like all <a href="https://github.com/naturalprogrammer/spring-lemon/blob/master/src/main/java/com/naturalprogrammer/spring/lemon/domain/VersionedEntity.java">VersionedEntity</a>, has a <code>version</code> column, which is incremented on each update.</p>
</div>
<div class="paragraph">
<p>While updating, it is first checked that the given version is equal to the version in the database record. Otherwise, it is assumed that someone else has updated the record concurrently, and the update fails. To use it, you will typically</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Along with the data to be updated, fetch the version column as well.</p>
</li>
<li>
<p>When the user submits the updated data, send the version back along with the updated data.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Precisely, we are talking about optimistic locking. The book <a href="https://gum.co/exuo/associate">Spring Framework REST API Development - A Complete Blueprint</a> covers it in more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="_response_13">Response</h3>
<div class="paragraph">
<p>Please note that the response is the data of the logged-in user, who isn&#8217;t necessarily the updated one.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Sun, 14 May 2017 14:08:07 GMT
Content-Length: 591

{
  "id" : 96,
  "email" : "admin@example.com",
  "roles" : [ "ADMIN" ],
  "unverified" : false,
  "blocked" : false,
  "admin" : true,
  "goodUser" : true,
  "goodAdmin" : true,
  "editable" : true,
  "rolesEditable" : false,
  "authorities" : [ {
    "authority" : "ROLE_ADMIN"
  }, {
    "authority" : "ROLE_GOOD_USER"
  }, {
    "authority" : "ROLE_GOOD_ADMIN"
  } ],
  "name" : "Administrator",
  "username" : "admin@example.com",
  "accountNonLocked" : true,
  "credentialsNonExpired" : true,
  "accountNonExpired" : true,
  "enabled" : true,
  "new" : false
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_14">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A user with the given <code>id</code> should exist.</p>
</li>
<li>
<p>Current-user should have <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/accessing_users.html">permission to edit</a> the given user.</p>
</li>
<li>
<p><code>roles</code> will be updated only if the current-user has <code>permission to edit</code> the roles.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If UNVERIFIED role is removed from a user, his <code>verificationCode</code> should be set to null.</p>
</li>
<li>
<p>If UNVERIFIED role is added to a user, a <code>verificationCode</code> should also be generated, and a verification mail should be sent to the user.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The new name <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/user_constraints.html">should be valid</a>.</p>
</li>
<li>
<p>The version column should be incremented on successful update.</p>
</li>
<li>
<p>The user shouldn&#8217;t have been already updated concurrently, i.e. the input <code>version</code> should match the version in the database. Otherwise, expect a <code>409</code> response.</p>
</li>
<li>
<p>If a user is updating himself, upon successful commit, the Security principal object is updated with the new name.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_13">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A non-admin user should be able to update his own name, but changes in roles should be skipped. The name of security principal object should also change in the process. The version column should be updated.</p>
</li>
<li>
<p>A good ADMIN should be able to update another user&#8217;s name and roles. Check that the name of security principal object should NOT change in the process by mistake.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>When making a user UNVERIFIED, a verificationCode should be generated.</p>
</li>
<li>
<p>When making a user verified, the verificationCode should be set to null.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_negative_test_cases_9">Negative test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Providing an unknown id in the path.</p>
</li>
<li>
<p>A non-admin trying to update the name and roles of another user.</p>
</li>
<li>
<p>A bad ADMIN trying to update the name and roles of another user.</p>
</li>
<li>
<p>A good ADMIN trying to change his own roles.</p>
</li>
<li>
<p>Providing an invalid name.</p>
</li>
<li>
<p>A change in version occuring.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_change_password">Change password</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Changes the password of a user</p>
</div>
<div class="sect2">
<h3 id="_request_14">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">POST /api/core/users/36/change-password HTTP/1.1
Accept: */*
X-XSRF-TOKEN: 604b7009-e6e6-4a04-994d-17956c3e6034
Content-Type: application/json;charset=UTF-8
Host: www.example.com
Content-Length: 102

{
  "oldPassword" : "user1!",
  "password" : "new-password",
  "retypePassword" : "new-password"
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_response_14">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 204 No Content
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Date: Sun, 14 May 2017 14:07:56 GMT</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_15">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A user with the given <code>id</code> should exist.</p>
</li>
<li>
<p>Current user should have <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/accessing_users.html">permission to edit</a> the given user.</p>
</li>
<li>
<p><code>oldPassword</code>, <code>password</code> and <code>retypePassword</code> should not be null or blank, and should be between 6 and 30 characters long.
<code>oldPassword</code> should match the user&#8217;s existing password.</p>
</li>
<li>
<p><code>password</code> and <code>retypePassword</code> should be same. (Ideally, this validation could have been left to the front-end. But, we thought to make this a server feature, for exibihiting how to code form-level custom validation.)</p>
</li>
<li>
<p>If a user is changing his own password, after successful commit, he should be logged out.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_14">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A non-admin user should be able to change his password. After changing password, he should have been logged out.</p>
</li>
<li>
<p>A good ADMIN should be able to update another user&#8217;s password.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_negative_test_cases_10">Negative test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Providing an unknown id in the path.</p>
</li>
<li>
<p>A non-admin trying to update the password of another user.</p>
</li>
<li>
<p>A bad ADMIN trying to update the password of another user.</p>
</li>
<li>
<p>Providing invalid passwords.</p>
</li>
<li>
<p>Providing wrong old password.</p>
</li>
<li>
<p><code>password</code> and <code>retypePassword</code> not being same.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="request-for-changing-email">Requesting for changing email</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A user (or a good ADMIN) can request for changing email id, by using the following request.</p>
</div>
<div class="sect2">
<h3 id="_request_15">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">POST /api/core/users/58/request-email-change HTTP/1.1
Accept: */*
X-XSRF-TOKEN: 341d28e6-03e4-4e96-a695-6b60402499c7
Content-Type: application/json;charset=UTF-8
Host: www.example.com
Content-Length: 642

{
  "id" : null,
  "version" : null,
  "email" : null,
  "password" : "user1!",
  "roles" : [ ],
  "verificationCode" : null,
  "forgotPasswordCode" : null,
  "newEmail" : "new@example.com",
  "changeEmailCode" : null,
  "apiKey" : null,
  "captchaResponse" : null,
  "unverified" : false,
  "blocked" : false,
  "admin" : false,
  "goodUser" : false,
  "goodAdmin" : false,
  "editable" : false,
  "rolesEditable" : false,
  "authorities" : null,
  "name" : null,
  "username" : null,
  "accountNonLocked" : true,
  "credentialsNonExpired" : true,
  "accountNonExpired" : true,
  "enabled" : true,
  "new" : true
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>On receiving such a request, an email containing a link is sent to the new email id. A secret <code>changeEmailCode</code> is embedded in the link. Clicking on the link brings the user back to the front-end, where first he should log in if he is not already. Then, he would click a button for sending the <a href="#final-change-email-request">[final-change-email-request]</a> for doing the final change.</p>
</div>
</div>
<div class="sect2">
<h3 id="_response_15">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 204 No Content
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Date: Sun, 14 May 2017 14:08:00 GMT</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_16">Business Rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A user with the given <code>id</code> should exist.</p>
</li>
<li>
<p>Current user should have <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/accessing_users.html">permission to edit</a> the given user.</p>
</li>
<li>
<p><code>password</code> should match the password of current-user.</p>
</li>
<li>
<p><code>newEmail</code> should not be blank, should be of a valid email format.</p>
</li>
<li>
<p><code>newEmail</code> should not already be used by any user.</p>
</li>
<li>
<p>The user should be logged out after the email has changed.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_15">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A UNVERIFIED non-admin user should be able to request changing his email.</p>
</li>
<li>
<p>A good ADMIN should be able to request changing the email of another user.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_negative_test_cases_11">Negative test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Providing an unknown id in the path.</p>
</li>
<li>
<p>A non-admin trying to request changing email of another user.</p>
</li>
<li>
<p>A bad ADMIN trying to request changing email of another user.</p>
</li>
<li>
<p>Providing null password and email.</p>
</li>
<li>
<p>Providing blank password and email.</p>
</li>
<li>
<p>Providing invalid email.</p>
</li>
<li>
<p>Providing wrong password.</p>
</li>
<li>
<p>Providing non-unique email.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_change_email">Change email</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a user <a href="#request-for-changing-email">requests for changing his email</a>, a mail is sent to him, which contains a link with a <code>changeEmailCode</code> embedded. Clicking on the link brings him back to the client, where first he should login if he is not already. He then would click a button for proceeding with the change, which will send the following request to the server.</p>
</div>
<div class="sect2">
<h3 id="_request_16">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">POST /api/core/users/0d9ae1a8-4857-4c0b-8b26-2d411fcc7f17/change-email HTTP/1.1
Accept: */*
X-XSRF-TOKEN: f0ff4f1e-7e21-47c5-9ce4-742d9581c49f
Content-Type: application/x-www-form-urlencoded; charset=ISO-8859-1
Host: www.example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Path Parameters</strong></p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. /api/core/users/{changeEmailCode}/change-email</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>changeEmailCode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The code that was mailed to the user</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_response_16">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 204 No Content
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Date: Sun, 14 May 2017 14:07:53 GMT</code></pre>
</div>
</div>
<div class="paragraph">
<p>The server will verify the <code>changeEmailCode</code>, and then do the change and log the user out.</p>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_17">Business rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The given <code>changeEmailCode</code> should not be blank.</p>
</li>
<li>
<p>The given <code>changeEmailCode</code> should match that of the current user in the database.</p>
</li>
<li>
<p>Before replacing <code>email</code> with <code>newEmail</code>, uniqueness should again be checked.</p>
</li>
<li>
<p>On success</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The user should be made verified if he is not already.</p>
</li>
<li>
<p>The user should be logged out.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_positive_test_cases_16">Positive test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>An unverified user, who had requested to change his email and had received the email with the link, should be able to change his email. The <code>newEmail</code> and <code>changeEmailCode</code> should be made null after the change, and he should have got verified. Also, he should have been logged out.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_negative_test_cases_12">Negative test cases</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A good ADMIN trying to post the <code>changeEmailCode</code> of another user.</p>
</li>
<li>
<p>Providing wrong <code>changeEmailCode</code>.</p>
</li>
<li>
<p>Trying the operation without having <a href="#request-for-changing-email">requested</a> first.</p>
</li>
<li>
<p>Trying after some user registers the <code>newEmail</code> meanwhile, leaving it non unique.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_api_key">Create API Key</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Creates an API key for a user, which can be used later for authorizing requests.</p>
</div>
<div class="sect2">
<h3 id="_request_17">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">POST /api/core/users/1/api-key HTTP/1.1
Accept: */*
X-XSRF-TOKEN: 0a086ba2-1dfc-4a5c-ac9a-dd2ee9c377cf
Content-Type: application/x-www-form-urlencoded; charset=ISO-8859-1
Host: www.example.com</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_response_17">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Sun, 14 May 2017 14:07:48 GMT
Content-Length: 57

{
  "apiKey" : "814c84fa-cbe9-4a3a-87e9-d183c66f5a28"
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_18">Business Rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A user with the given <code>id</code> should exist.</p>
</li>
<li>
<p>Current user should have <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/accessing_users.html">permission to edit</a> the given user.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_api_key">Use API Key</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The API key of a user can be used for custom token authentication, as below.</p>
</div>
<div class="sect2">
<h3 id="_request_18">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">PATCH /api/core/users/1 HTTP/1.1
Authorization: Bearer 1:814c84fa-cbe9-4a3a-87e9-d183c66f5a28
Accept: */*
Content-Type: application/json;charset=UTF-8
Host: www.example.com
Content-Length: 282

[ {
  "op" : "replace",
  "path" : "/name",
  "value" : "Edited name"
}, {
  "op" : "replace",
  "path" : "/unverified",
  "value" : true
}, {
  "op" : "replace",
  "path" : "/admin",
  "value" : true
}, {
  "op" : "replace",
  "path" : "/version",
  "value" : 1
} ]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Headers</strong></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Authorization</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom token authentication - of the format <em>userId:api-key</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_response_18">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Set-Cookie: XSRF-TOKEN=0e52f5d0-8631-48e0-8d71-e6cfdcb36640;path=/
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Sun, 14 May 2017 14:07:49 GMT
Content-Length: 588

{
  "id" : 1,
  "email" : "admin@example.com",
  "roles" : [ "ADMIN" ],
  "unverified" : false,
  "blocked" : false,
  "admin" : true,
  "goodUser" : true,
  "goodAdmin" : true,
  "editable" : true,
  "rolesEditable" : false,
  "authorities" : [ {
    "authority" : "ROLE_ADMIN"
  }, {
    "authority" : "ROLE_GOOD_USER"
  }, {
    "authority" : "ROLE_GOOD_ADMIN"
  } ],
  "name" : "Edited name",
  "username" : "admin@example.com",
  "accountNonLocked" : true,
  "credentialsNonExpired" : true,
  "accountNonExpired" : true,
  "enabled" : true,
  "new" : false
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_remove_api_key">Remove API Key</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The API key of a user can be removed as below.</p>
</div>
<div class="sect2">
<h3 id="_request_19">Request</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">DELETE /api/core/users/1/api-key HTTP/1.1
Accept: */*
X-XSRF-TOKEN: 4105ddc3-4b13-4fb7-9e6c-523fe58199de
Host: www.example.com</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_response_19">Response</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 204 No Content
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Frame-Options: DENY
Date: Sun, 14 May 2017 14:07:49 GMT</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business_rules_19">Business Rules</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A user with the given <code>id</code> should exist.</p>
</li>
<li>
<p>Current user should have <a href="https://naturalprogrammer.gitbooks.io/spring-lemon-getting-started/content/common/accessing_users.html">permission to edit</a> the given user.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-05-14 19:35:38 IST
</div>
</div>
</body>
</html>